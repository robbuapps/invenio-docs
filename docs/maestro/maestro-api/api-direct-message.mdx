---
title: "Direct Message API - Maestro"
sidebarTitle: "Direct Message API - Maestro"
description: "Envio de mensagens transacionais via E-mail, SMS e WhatsApp usando a infraestrutura do Maestro."
---

## Cliente

MAESTRO

**Data de cria√ß√£o:** 14/08/2025\
**Respons√°vel pela Documenta√ß√£o:** Engenharia

**Precisa de libera√ß√£o de IPs do lado do Robbu?** N√£o\
**IP‚Äôs:** ‚Äî

## Informa√ß√µes Gerais

**Vers√£o da API:** V1\
**Nome da API:** Direct Message API\
**Canais suportados:** Envio de mensagens sem campanha ‚Äî E-mail, SMS e WhatsApp

---

## Vis√£o Geral

A API Direct Message permite o disparo de mensagens transacionais (fora do ciclo de campanhas) utilizando os mesmos recursos de infraestrutura do Maestro, incluindo:

- Motor de regras de valida√ß√£o de mensagem
- Servi√ßos e brokers configurados no Maestro
- Workers dedicados e filas segregadas por empresa (Service Bus)

Este servi√ßo √© ideal para integra√ß√µes automatizadas, como envio de confirma√ß√µes, alertas, autentica√ß√µes e notifica√ß√µes em tempo real.

---

## Base URL

**Produ√ß√£o:**

## https://api.common.maestro.robbu.global/

---

## üß© Vari√°veis de Template

**E-mail e SMS**\
Utilize o campo `variable_values` para informar vari√°veis din√¢micas conforme o template configurado no Maestro:

```json
"variable_values": {
  "nome": "Jo√£o Silva",
  "codigo": "CDI-00987"
}

Endpoints
1. Envio de E-mail

POST /v1/directmessage/email

Request Body:
{
  "recipient_email": "usuario@dominio.com",
  "subject": "Assunto do E-mail",
  "free_text": "Texto livre (opcional)",
  "variable_values": {
    "chave1": "valor1",
    "chave2": "valor2"
  },
  "contact_name": "Jo√£o Silva",
  "document_number": "12345678900",
  "contract_code": "CT-98765",
  "template_code": "TEMPLATE_EMAIL_001"
}

2. Envio de WhatsApp

POST /v1/directmessage/whatsapp

Request Body:

{
  "recipient_number": "+5511999998888",
  "whatsapp_sender_number": "+5500000000000",
  "variables": {
    "header_key": "1",
    "header_value": "Jo√£o Silva",
    "body": {
      "1": "CDI-00987",
      "2": "R. Padre Anchieta, 115. Centro."
    }
  },
  "contact_name": "Jo√£o Silva",
  "document_number": "12345678900",
  "contract_code": "CT-000123",
  "template_code": "TEMPLATE_WPP_003"
}

3. Envio de SMS

POST /v1/directmessage/sms

Request Body:

{
  "recipient_number": "+5511999998888",
  "free_text": "Texto do SMS (opcional)",
  "variable_values": {
    "codigo": "123456",
    "nome": "Jo√£o"
  },
  "contact_name": "Jo√£o Silva",
  "document_number": "12345678900",
  "contract_code": "CT-00987",
  "template_code": "TEMPLATE_SMS_002"
}

```
## üì¨ Respostas

| C√≥digo                        | Descri√ß√£o                                                                         |
| ----------------------------- | --------------------------------------------------------------------------------- |
| **200 - OK**                  | Mensagem em processamento ‚Äî Passou pelas valida√ß√µes e foi enfileirada para envio. |
| **200 - OK**                  | Mensagem validada, mas n√£o enviada ‚Äî N√£o h√° servi√ßo configurado para o canal.     |
| **401 - Unauthorized**        | Falha na autentica√ß√£o.                                                            |
| **422 - UnprocessableEntity** | Erros de valida√ß√£o ‚Äî Campos obrigat√≥rios n√£o preenchidos ou dados inv√°lidos.      |
| **409 - Conflict**            | Erros de valida√ß√£o do Motor de Regras ‚Äî Lista os motivos de bloqueio.             |


## üí° Boas Pr√°ticas

Valide previamente os templates e vari√°veis definidos no Maestro.

Sempre trate erros 401 e 403 com l√≥gica de fallback ou renova√ß√£o de token.

Implemente monitoramento e logs para mensurar falhas por canal e acionar novas tentativas ou alertas.

## üîí Seguran√ßa

Para utilizar o servi√ßo Direct Message, √© necess√°rio fornecer um JWT Token no cabe√ßalho Authorization das requisi√ß√µes POST.

O token deve ser obtido em:
Configura√ß√µes > Empresa no Maestro.

Aten√ß√£o: Ao gerar um novo token para a empresa do usu√°rio logado, o token anterior √© automaticamente revogado.

## ‚ùì FAQ

1. Posso enviar mensagens sem configurar um template no Maestro?
N√£o. √â obrigat√≥rio vincular um template previamente configurado.

2. E se o canal n√£o estiver configurado?
A API retornar√° 200 - OK, mas informando que n√£o h√° servi√ßo de envio para aquele canal.

3. Como renovar o token?
Acesse Configura√ß√µes > Empresa e gere um novo token. Lembre-se: o token anterior ser√° revogado.

4. Qual o tempo de processamento da mensagem?
O envio √© feito em tempo real, dependendo da disponibilidade do canal.

5. √â poss√≠vel monitorar erros de envio?
Sim, utilizando logs e monitoramento de falhas por canal.